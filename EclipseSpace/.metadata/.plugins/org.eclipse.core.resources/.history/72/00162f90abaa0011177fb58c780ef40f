import os
import re
import sys
import signal
import json
from time import sleep, time
from threading import Thread, Lock

fb_wall_last_value = 0
num_threads = 10
json_files= {}

if(len(sys.argv) > 1):
    for root, dirs, files in os.walk(sys.argv[1]):
        os.chdir(sys.argv[1])
        for dir in dirs:
            message_ids = {}
            fb_wall_last_value = fb_wall_last_value + 1
            for root_next, dirs_next, files_next in os.walk(dir):
                for each_file in files_next:
#                        print (sys.argv[1]+dir+'/'+each_file)
                    json_strings = open (sys.argv[1]+dir+'/'+each_file)
                    json_files[dir+'/'+each_file] = fb_wall_last_value
                    #raw_input('press a key')
                    describe_this(json_strings)
else:
    print('Give a path for Json directories')


worker_list = []
# Makes 10 workers, each of them will issue a request every 10 seconds.
# Total request rate: 10/10*3600 = 3600.
signal.signal(signal.SIGPIPE, signal.SIG_IGN)
for i in range(num_threads):
    worker_id = Thread(target = worker)
    worker_list.append(worker_id)
    worker_id.daemon = True
    worker_id.start()

# Blocks until all tasks are done.
for worker_id in worker_list:
    worker_id.join()

#status.close()

